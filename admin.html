<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin-Bereich - T√∂GGeli-Cup</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #5B3A2E;
            color: white;
            text-align: center;
            margin: 20px;
        }
        h1, h2 {
            font-weight: bold;
        }
        input, textarea, button {
            margin: 5px;
            padding: 10px;
            font-size: 16px;
        }
        table {
            width: 80%;
            margin: 10px auto;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            border: 1px solid black;
            background-color: white;
            color: black;
        }
        th {
            background-color: #0059B2;
            color: white;
        }
    </style>
</head>
<body>
    <h1>Admin-Bereich</h1>

    <h2>Teams verwalten</h2>
    <input type="text" id="teamName" placeholder="Teamname">
    <input type="text" id="player1" placeholder="Spieler:in 1">
    <input type="text" id="player2" placeholder="Spieler:in 2">
    <button onclick="addTeam()">Team hinzuf√ºgen</button>

    <h2>News verwalten</h2>
    <textarea id="newsText" rows="3" cols="50" placeholder="Neue News..."></textarea>
    <button onclick="addNews()">News hinzuf√ºgen</button>

    <h2>Resultate</h2>
    <table>
        <thead>
            <tr>
                <th>Team 1</th>
                <th>Team 2</th>
                <th>Ergebnis</th>
                <th>Aktion</th>
            </tr>
        </thead>
        <tbody id="resultsTable"></tbody>
    </table>
    <button onclick="saveResults()">√Ñnderungen speichern</button>

    <!-- Firebase JS -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
        import { getDatabase, ref, push, set, get, child } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-database.js";

        // üî• Firebase Konfiguration
        const firebaseConfig = {
            apiKey: "AIzaSyD2nmuFhdG0ZU5wO9H7CqsxPnRF04WZLzY",
            authDomain: "toeggeli-cup-2025.firebaseapp.com",
            databaseURL: "https://toeggeli-cup-2025-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "toeggeli-cup-2025",
            storageBucket: "toeggeli-cup-2025.firebasestorage.app",
            messagingSenderId: "810841513587",
            appId: "1:810841513587:web:fc9d2b0274cf92b3ae1406"
        };

        // Firebase Initialisieren
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // üèÜ **Team hinzuf√ºgen**
        function addTeam() {
            const teamName = document.getElementById("teamName").value.trim();
            const player1 = document.getElementById("player1").value.trim();
            const player2 = document.getElementById("player2").value.trim();

            if (teamName && player1 && player2) {
                const newTeamRef = push(ref(db, "teams/"));  // üî• `push()` richtig angewendet
                set(newTeamRef, { name: teamName, player1: player1, player2: player2 })
                    .then(() => console.log("‚úÖ Team erfolgreich hinzugef√ºgt:", teamName))
                    .catch(error => console.error("‚ùå Fehler beim Speichern des Teams:", error));

                document.getElementById("teamName").value = "";
                document.getElementById("player1").value = "";
                document.getElementById("player2").value = "";
            } else {
                alert("Bitte alle Felder ausf√ºllen!");
            }
        }

        // üì∞ **News hinzuf√ºgen**
        function addNews() {
            const newsText = document.getElementById("newsText").value.trim();
            if (newsText) {
                const newNewsRef = push(ref(db, "news/"));  // üî• `push()` f√ºr News richtig angewendet
                set(newNewsRef, { text: newsText, date: new Date().toLocaleString() })
                    .then(() => console.log("‚úÖ News erfolgreich hinzugef√ºgt:", newsText))
                    .catch(error => console.error("‚ùå Fehler beim Speichern der News:", error));

                document.getElementById("newsText").value = "";
            } else {
                alert("Bitte eine News eingeben!");
            }
        }

        // ‚öΩ **Resultate speichern**
        function saveResults() {
            const results = [];
            document.querySelectorAll("#resultsTable tr").forEach(row => {
                const team1 = row.cells[0].innerText;
                const team2 = row.cells[1].innerText;
                const score = row.cells[2].querySelector("input").value;
                if (score) {
                    results.push({ team1, team2, score });
                }
            });

            if (results.length > 0) {
                set(ref(db, "results/"), results)
                    .then(() => console.log("‚úÖ Ergebnisse gespeichert"))
                    .catch(error => console.error("‚ùå Fehler beim Speichern der Ergebnisse:", error));
            } else {
                alert("Keine Ergebnisse zum Speichern!");
            }
        }

        // üîÑ **Daten aus Firebase laden**
        function loadData() {
            get(child(ref(db), "teams")).then(snapshot => {
                if (snapshot.exists()) {
                    console.log("üì• Teams geladen:", snapshot.val());
                }
            }).catch(error => console.error("‚ùå Fehler beim Laden der Teams:", error));

            get(child(ref(db), "news")).then(snapshot => {
                if (snapshot.exists()) {
                    console.log("üì• News geladen:", snapshot.val());
                }
            }).catch(error => console.error("‚ùå Fehler beim Laden der News:", error));

            get(child(ref(db), "results")).then(snapshot => {
                if (snapshot.exists()) {
                    console.log("üì• Ergebnisse geladen:", snapshot.val());
                }
            }).catch(error => console.error("‚ùå Fehler beim Laden der Ergebnisse:", error));
        }

        // Starte das Laden der Daten
        loadData();
    </script>
</body>
</html>
